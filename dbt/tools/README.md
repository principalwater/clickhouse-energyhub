# üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã dbt

–≠—Ç–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å dbt –º–æ–¥—É–ª–µ–º.

## üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã

### üéØ `dbt-manager.sh` - –û—Å–Ω–æ–≤–Ω–æ–π –º–µ–Ω–µ–¥–∂–µ—Ä dbt
**–£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å dbt**

```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
./dbt-manager.sh setup

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
./dbt-manager.sh check

# –ó–∞–ø—É—Å–∫ –º–æ–¥–µ–ª–µ–π
./dbt-manager.sh run
./dbt-manager.sh run prod
./dbt-manager.sh run dev model_name

# –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
./dbt-manager.sh test
./dbt-manager.sh test prod

# –ö–æ–º–ø–∏–ª—è—Ü–∏—è –º–æ–¥–µ–ª–µ–π
./dbt-manager.sh compile

# –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
./dbt-manager.sh docs

# –ó–∞–ø—É—Å–∫ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
./dbt-manager.sh serve

# –°–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π
./dbt-manager.sh list

# –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
./dbt-manager.sh debug

# –°–ø—Ä–∞–≤–∫–∞
./dbt-manager.sh help
```

### üîß `activate.sh` - –ê–∫—Ç–∏–≤–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
**–ë—ã—Å—Ç—Ä–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è dbt –æ–∫—Ä—É–∂–µ–Ω–∏—è**

```bash
source ./activate.sh
```

### üîç `diagnose.sh` - –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è dbt –æ–∫—Ä—É–∂–µ–Ω–∏—è**

```bash
./diagnose.sh
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   ```bash
   cd dbt/tools
   ./dbt-manager.sh setup
   ```

2. **–ê–∫—Ç–∏–≤–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   ```bash
   source ./activate.sh
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏:**
   ```bash
   ./dbt-manager.sh check
   ```

4. **–ó–∞–ø—É—Å–∫ –º–æ–¥–µ–ª–µ–π:**
   ```bash
   ./dbt-manager.sh run
   ```

## üîë –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑:
- `../../infra/terraform/Terraform.tfvars` (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω)
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:**
- `CLICKHOUSE_USER` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ClickHouse (–∑–Ω–∞—á–µ–Ω–∏–µ `super_user_name` –∏–∑ `terraform.tfvars`)
- `CLICKHOUSE_PASSWORD` - –ø–∞—Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∑–Ω–∞—á–µ–Ω–∏–µ `super_user_password` –∏–∑ `terraform.tfvars`)
- `CLICKHOUSE_HOST` - —Ö–æ—Å—Ç ClickHouse
- `CLICKHOUSE_PORT` - –ø–æ—Ä—Ç ClickHouse
- `CLICKHOUSE_DATABASE` - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
dbt/tools/
‚îú‚îÄ‚îÄ dbt-manager.sh    # –û—Å–Ω–æ–≤–Ω–æ–π –º–µ–Ω–µ–¥–∂–µ—Ä
‚îú‚îÄ‚îÄ activate.sh       # –ê–∫—Ç–∏–≤–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ diagnose.sh       # –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
‚îî‚îÄ‚îÄ README.md         # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- **–î–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã:** –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `dbt-manager.sh`
- **–î–ª—è –±—ã—Å—Ç—Ä–æ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏:** –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `activate.sh`
- **–î–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ –ø—Ä–æ–±–ª–µ–º:** –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `diagnose.sh`
- **–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:** –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `dbt-manager.sh debug`

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `../../infra/terraform/load_env.sh` - –∑–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–∑ Terraform
- `../profiles/profiles.yml` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ—Ñ–∏–ª–µ–π dbt
- `../dbt_project.yml` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞ dbt
