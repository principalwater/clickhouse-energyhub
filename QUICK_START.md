# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç ClickHouse EnergyHub

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è: ~15 –º–∏–Ω—É—Ç**

–≠—Ç–æ—Ç —Ç—É—Ç–æ—Ä–∏–∞–ª –ø–æ–º–æ–∂–µ—Ç –≤–∞–º –±—ã—Å—Ç—Ä–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å ClickHouse EnergyHub —Å –Ω—É–ª—è. –í—Å–µ –∫–æ–º–∞–Ω–¥—ã –ø–æ—à–∞–≥–æ–≤—ã–µ –∏ –≥–æ—Ç–æ–≤—ã –∫ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—é!

## üìã –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:

- **Docker** (–≤–µ—Ä—Å–∏—è 20.10+)
- **Terraform** (–≤–µ—Ä—Å–∏—è 1.0+)
- **Python 3.8+**
- **Git**

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

```bash
# –ü—Ä–æ–≤–µ—Ä—è–µ–º Docker
docker --version

# –ü—Ä–æ–≤–µ—Ä—è–µ–º Terraform
terraform --version

# –ü—Ä–æ–≤–µ—Ä—è–µ–º Python
python3 --version

# –ü—Ä–æ–≤–µ—Ä—è–µ–º Git
git --version
```

## üéØ –®–∞–≥ 1: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
# –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/principalwater/clickhouse-energyhub.git

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd clickhouse-energyhub

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
ls -la
```

## üîß –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –¥–ª—è Terraform:

```bash
# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é Terraform
cd infra/terraform

# –°–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ (—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä)
cp terraform.tfvars.example terraform.tfvars

# –†–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º —Ñ–∞–π–ª (–∑–∞–º–µ–Ω–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞ —Å–≤–æ–∏)
nano terraform.tfvars
```

**–ü—Ä–∏–º–µ—Ä —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ `terraform.tfvars`:**

```hcl
# –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å—É–ø–µ—Ä–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
super_user_name = "admin"
super_user_password = "your_secure_password"

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ClickHouse
clickhouse_version = "23.8"
clickhouse_cluster_size = 4

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Airflow
airflow_version = "2.7.1"
```

## üöÄ –®–∞–≥ 3: –ó–∞–ø—É—Å–∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

```bash
# –í–æ–∑–≤—Ä–∞—â–∞–µ–º—Å—è –≤ –∫–æ—Ä–µ–Ω—å –ø—Ä–æ–µ–∫—Ç–∞
cd ../../

# –î–µ–ª–∞–µ–º —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x deploy.sh

# –ó–∞–ø—É—Å–∫–∞–µ–º —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
./deploy.sh
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤–æ –≤—Ä–µ–º—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:**

1. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (Docker, Terraform, Python)
2. üîê –ó–∞–≥—Ä—É–∑–∫–∞ —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ `terraform.tfvars`
3. üèóÔ∏è –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Terraform
4. üìã –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
5. üöÄ –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã
6. üì¶ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
7. üîÑ –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã

**–í–Ω–∏–º–∞–Ω–∏–µ:** –ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤–≤–µ–¥–∏—Ç–µ `y` –∏ –Ω–∞–∂–º–∏—Ç–µ Enter.

## ‚è≥ –®–∞–≥ 4: –û–∂–∏–¥–∞–Ω–∏–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏

–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –∑–∞–Ω–∏–º–∞–µ—Ç **10-15 –º–∏–Ω—É—Ç**. –í—ã —É–≤–∏–¥–∏—Ç–µ –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ.

**–ü—Ä–∏–∑–Ω–∞–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:**
- ‚úÖ –í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã
- üü¢ –°—Ç–∞—Ç—É—Å "healthy" –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- üìä –í—ã–≤–æ–¥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã—Ö —Ä–µ—Å—É—Ä—Å–∞—Ö

## üéâ –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∞ ClickHouse

```bash
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ ClickHouse
docker exec -it clickhouse-01 clickhouse-client --user admin --password 'your_secure_password'

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö
SHOW DATABASES;

# –í—ã—Ö–æ–¥ –∏–∑ –∫–ª–∏–µ–Ω—Ç–∞
EXIT;
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ Airflow

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ Airflow
docker exec airflow-scheduler airflow dags list

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
curl http://localhost:8080
```

**Airflow UI –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:** http://localhost:8080

**–õ–æ–≥–∏–Ω:** `airflow` / `airflow`

## üß™ –®–∞–≥ 6: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ dbt

```bash
# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é dbt
cd dbt/tools

# –î–µ–ª–∞–µ–º —Å–∫—Ä–∏–ø—Ç—ã –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏
chmod +x *.sh

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ dbt
./dbt-manager.sh setup

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
./dbt-manager.sh check

# –ó–∞–ø—É—Å–∫ –º–æ–¥–µ–ª–µ–π
./dbt-manager.sh run
```

## üìä –®–∞–≥ 7: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∞–±–ª–∏—Ü –≤ ClickHouse
docker exec clickhouse-01 clickhouse-client --user admin --password 'your_secure_password' --query "
SELECT 
    database,
    name,
    engine
FROM system.tables 
WHERE database IN ('raw', 'ods', 'dds', 'cdm')
ORDER BY database, name;
"
```

## üåê –î–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å–∞–º

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –≤–∞–º –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã:

| –°–µ—Ä–≤–∏—Å        | URL                    | –õ–æ–≥–∏–Ω/–ü–∞—Ä–æ–ª—å                    |
|---------------|------------------------|--------------------------------|
| **Airflow**   | http://localhost:8080  | `airflow` / `airflow`          |
| **ClickHouse**| localhost:9000         | `admin` / `your_password`      |
| **Superset**  | http://localhost:8088  | `admin` / `admin`              |
| **Metabase**  | http://localhost:3000  | `admin@example.com` / `admin`  |
| **Portainer** | http://localhost:9443  | –°–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ      |

## üö® –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: Docker –Ω–µ –∑–∞–ø—É—â–µ–Ω
```bash
# –ó–∞–ø—É—Å–∫ Docker
sudo systemctl start docker
sudo systemctl enable docker
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ü–æ—Ä—Ç—ã –∑–∞–Ω—è—Ç—ã
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–Ω—è—Ç—ã—Ö –ø–æ—Ä—Ç–æ–≤
sudo netstat -tulpn | grep :8080

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
sudo systemctl stop conflicting-service
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–∞–º—è—Ç–∏
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ–π –ø–∞–º—è—Ç–∏
free -h

# –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ Docker (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
# –í /etc/docker/daemon.json –¥–æ–±–∞–≤—å—Ç–µ:
# {
#   "default-memory": "4g"
# }
```

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ Terraform
```bash
# –û—á–∏—Å—Ç–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è Terraform
cd infra/terraform
terraform destroy -auto-approve
terraform init
./deploy.sh
```

## üìö –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:

1. **–ò–∑—É—á–∏—Ç–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É** ‚Üí [docs/ARCHITECTURE.md](ARCHITECTURE.md)
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** ‚Üí [docs/MONITORING.md](MONITORING.md)
3. **–°–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ–∏ dbt –º–æ–¥–µ–ª–∏** ‚Üí [docs/DBT_INTEGRATION.md](DBT_INTEGRATION.md)
4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ CI/CD** ‚Üí [docs/CI_CD.md](CI_CD.md)

## üÜò –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–º–æ—â–∏

- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** [docs/](docs/)
- **Issues:** [GitHub Issues](https://github.com/principalwater/clickhouse-energyhub/issues)
- **Discussions:** [GitHub Discussions](https://github.com/principalwater/clickhouse-energyhub/discussions)

## üéØ –ß—Ç–æ –≤—ã –ø–æ–ª—É—á–∏–ª–∏

‚úÖ **–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π ClickHouse –∫–ª–∞—Å—Ç–µ—Ä** —Å 4 —É–∑–ª–∞–º–∏  
‚úÖ **Airflow** –¥–ª—è –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö  
‚úÖ **dbt** –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö  
‚úÖ **Superset & Metabase** –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏  
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ DAG'–∏** –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö  
‚úÖ **–°–∏—Å—Ç–µ–º—É –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏–∏** –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç  
‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**  

**–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! üéâ –í–∞—à ClickHouse EnergyHub —É—Å–ø–µ—à–Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!**
